# ğŸ¤– AutomaÃ§Ã£o VR/VA

Sistema automatizado para processamento mensal de Vale RefeiÃ§Ã£o, aplicando todas as regras de negÃ³cio e sindicatos.

## ğŸ“ Estrutura do Projeto

```
projeto-vr-automation/
â”‚
â”œâ”€â”€ src/                          # CÃ³digo fonte
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ vr_automation.py          # LÃ³gica principal
â”‚
â”œâ”€â”€ data/                         # Arquivos Excel de entrada
â”‚   â”œâ”€â”€ ADMISSÃƒO ABRIL.xlsx
â”‚   â”œâ”€â”€ AFASTAMENTOS.xlsx
â”‚   â”œâ”€â”€ APRENDIZ.xlsx
â”‚   â”œâ”€â”€ ATIVOS.xlsx
â”‚   â”œâ”€â”€ Base dias uteis.xlsx
â”‚   â”œâ”€â”€ Base sindicato x valor.xlsx
â”‚   â”œâ”€â”€ DESLIGADOS.xlsx
â”‚   â”œâ”€â”€ ESTÃGIO.xlsx
â”‚   â”œâ”€â”€ EXTERIOR.xlsx
â”‚   â””â”€â”€ FÃ‰RIAS.xlsx
â”‚
â”œâ”€â”€ output/                       # Arquivos gerados
â”‚
â”œâ”€â”€ main.py                       # Script de execuÃ§Ã£o
â”œâ”€â”€ requirements.txt              # DependÃªncias
â””â”€â”€ README.md                     # Este arquivo
```

## ğŸš€ InstalaÃ§Ã£o

1. **Clone ou baixe o projeto**
2. **Instale as dependÃªncias:**

   ```bash
   pip install -r requirements.txt
   ```

3. **Coloque os arquivos Excel na pasta `data/`**

## â–¶ï¸ Como Executar

### ExecuÃ§Ã£o simples:

```bash
python main.py
```

### Para alterar competÃªncia, edite no `main.py`:

```python
MES_COMPETENCIA = 6   # Junho
ANO_COMPETENCIA = 2025
```

## ğŸ“‹ Arquivos NecessÃ¡rios na pasta `data/`

| Arquivo                       | DescriÃ§Ã£o                     |
| ----------------------------- | ----------------------------- |
| `ADMISSÃƒO ABRIL.xlsx`         | FuncionÃ¡rios admitidos no mÃªs |
| `AFASTAMENTOS.xlsx`           | LicenÃ§as e afastamentos       |
| `APRENDIZ.xlsx`               | Base de aprendizes            |
| `ATIVOS.xlsx`                 | FuncionÃ¡rios ativos           |
| `Base dias uteis.xlsx`        | Dias Ãºteis por sindicato      |
| `Base sindicato x valor.xlsx` | Valores por estado            |
| `DESLIGADOS.xlsx`             | FuncionÃ¡rios desligados       |
| `ESTÃGIO.xlsx`                | Base de estagiÃ¡rios           |
| `EXTERIOR.xlsx`               | FuncionÃ¡rios no exterior      |
| `FÃ‰RIAS.xlsx`                 | FuncionÃ¡rios em fÃ©rias        |

## âš™ï¸ Regras Implementadas

### âŒ **ExclusÃµes AutomÃ¡ticas:**

- Diretores (cargo contÃ©m "DIRETOR")
- EstagiÃ¡rios e Aprendizes
- Afastados (licenÃ§as)
- FuncionÃ¡rios no exterior

### ğŸ“… **Regras de Desligamento:**

- **AtÃ© dia 15**: Se comunicado = "OK", nÃ£o pagar
- **ApÃ³s dia 15**: Pagar proporcional

### ğŸ’° **CÃ¡lculo Financeiro:**

- **Base**: Dias Ãºteis do sindicato
- **Descontos**: FÃ©rias
- **Proporcionais**: AdmissÃµes/demissÃµes no meio do mÃªs
- **Rateio**: 80% empresa / 20% funcionÃ¡rio

## ğŸ“Š SaÃ­da

O sistema gera na pasta `output/`:

- **VR_MENSAL_MM_AAAA.xlsx**: Planilha final para envio Ã  operadora

## ğŸ” ValidaÃ§Ãµes

âœ… Dias vÃ¡lidos (nÃ£o negativos)  
âœ… Valores consistentes  
âœ… Rateio correto (80%/20%)  
âœ… MatrÃ­culas Ãºnicas

## ğŸ› ï¸ SoluÃ§Ã£o de Problemas

**Erro "Pasta data nÃ£o encontrada"**

- Criar pasta `data/` e colocar os arquivos Excel

**Erro ao carregar arquivo**

- Verificar se arquivos nÃ£o estÃ£o abertos no Excel
- Conferir nomes exatos dos arquivos

**ValidaÃ§Ãµes falharam**

- Conferir dados de entrada
- Verificar regras de negÃ³cio aplicadas

## ğŸ“ˆ Performance

- â±ï¸ **Tempo**: ~10-30 segundos (1000 funcionÃ¡rios)
- ğŸ’¾ **MemÃ³ria**: ~50-100MB
- ğŸ“ **SaÃ­da**: ~100-500KB

## ğŸ¯ PrÃ³ximos Passos

1. Colocar arquivos na pasta `data/`
2. Executar `python main.py`
3. Conferir arquivo gerado em `output/`
4. Enviar para operadora

---

_Sistema desenvolvido para automaÃ§Ã£o do processo mensal de VR/VA_
